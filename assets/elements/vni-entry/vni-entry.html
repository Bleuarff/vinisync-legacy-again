<link rel="import" href="../../bower_components/paper-button/paper-button.html">
<link rel="import" href="../../bower_components/paper-input/paper-input.html">
<link rel="import" href="../../bower_components/vaadin-combo-box/vaadin-combo-box.html">
<link rel="import" href="../../bower_components/paper-dropdown-menu/paper-dropdown-menu-light.html">
<link rel="import" href="../../bower_components/paper-tabs/paper-tabs.html">
<link rel="import" href="../../bower_components/paper-tabs/paper-tab.html">
<link rel="import" href="../../bower_components/paper-checkbox/paper-checkbox.html">
<link rel='import' href='../../bower_components/iron-icons/iron-icons.html'>
<link rel='import' href='../../bower_components/iron-icons/image-icons.html'>
<link rel='import' href='../../bower_components/iron-icon/iron-icon.html'>
<link rel='import' href="../vni-cepages/vni-cepages.html">
<link rel="import" href="../vni-color/vni-color.html">
<link rel='import' href="../../styles/shared-styles.html">

<dom-module id='vni-entry'>
  <template>
    <style include='shared-styles'>
      .apogee {
        display: flex;
        flex-flow: row nowrap;
        align-items: center;
      }

      .containing {
        width: 100%;
      }

      paper-tabs {
        --paper-tabs-selection-bar-color: var(--vni-main-color);
        font-size: 1rem;
      }

      .tags {
        display: flex;
        flex-flow: row wrap;
        justify-content: space-around;
      }

      .photo-btn {
        background: transparent;
        border: none;
        display: block;
        margin: auto;
        width: 50%;
        max-width: 10em;
      }

      .photo-icon {
        width: 3em;
        height: 3em;
        color: grey;
        cursor: pointer;
      }

      .uploader {
        position: absolute;
        opacity: 0;
      }

      .entry-img {
        display: block;
        margin: auto;
        max-width: 100%;
        max-height: 12em;
      }

    </style>

    <app-route route="[[route]]"
    pattern="/:id"
    data="{{routeData}}">
    </app-route>

    <div class='photo'>
      <template is='dom-if' if='[[!hasPhoto]]'>
        <input type="file" name="logo" id="logo" class="uploader" accept='image/*' capture on-change='setPhoto'/>
        <button on-tap='selectPhoto' class='photo-btn'>
          <iron-icon icon='image:camera-alt' class='photo-icon'></iron-icon>
        </button>
      </template>
      <template is='dom-if' if='[[hasPhoto]]'>
        <img class='entry-img' src='[[entry.wine.image]]'>
      </template>
    </div>

    <vaadin-combo-box id='appellation' label='Appellation' value='{{entry.wine.appellation}}' allow-custom-value='true'
    on-input='appellationChanged'>
    </vaadin-combo-box>

    <vaadin-combo-box id='producer' label='Producteur' value='{{entry.wine.producer}}' allow-custom-value='true'
    on-input='producerChanged'>
    </vaadin-combo-box>

    <paper-input id='name' label='Cuvée' value='{{entry.wine.name}}'></paper-input>

    <paper-input id='year' label='Millésime' value='{{entry.wine.year}}' type='number' min='1700' max='[[currentYear]]'>
    </paper-input>

    <vaadin-combo-box label='Pays' value='{{entry.wine.country}}' items='[[countries]]' allow-custom-value='true'></vaadin-combo-box>

    <div class='apogee'>
      <paper-input label='Apogée' value='{{entry.wine.apogeeStart}}' type='number' min='1700'></paper-input>
      -
      <paper-input label="Jusqu'à" value='{{entry.wine.apogeeEnd}}' type='number' min='[[entry.wine.apogeeStart]]'></paper-input>
    </div>

    <vni-color color='{{entry.wine.color}}'></vni-color>

    <paper-input label='Quantité' type='number' value='{{entry.count}}' min='1' max='100'></paper-input>

    <vni-cepages cepages='[[cepages]]'></vni-cepages>

    <span>Détails:</span>
    <div class='tags'>
      <paper-checkbox checked='{{entry.wine.sparkling}}' class='tag'>pétillant</paper-checkbox>
      <paper-checkbox checked='{{entry.wine.sweet}}' class='tag'>liquoreux</paper-checkbox>
    </div>

    <paper-dropdown-menu-light label='Contenant' class='containing'>
      <paper-tabs class='dropdown-content' attr-for-selected='value' selected='{{entry.wine.containing}}'>
        <template is='dom-repeat' items='[[containings]]'>
          <paper-tab value='[[item]]'>[[item]]</paper-tab>
        </template>
      </paper-tabs>
    </paper-dropdown-menu-light>

    <paper-input label='Offert par' value='{{entry.offeredBy}}'></paper-input>

    <paper-button class='default' on-tap='save'>Enregistrer</paper-button>
  </template>
  <script src="vni-entry.js"></script>
</dom-module>
